{
  "hash": "81e0f5b6eb8a74aef098ee3757f4a21d",
  "result": {
    "markdown": "---\ntitle: \"Bayesian Modeling for Psychologists, Part 1\"\ndescription: \"Updating our statistical skills\"\nauthor: \"Tomer Zipori\"\ndate: last-modified\ncategories: [code, tutorial, Bayes]\nimage: \"favicon.png\"\nexecute: \n  warning: false\n  message: false\n  cache: false\nformat:\n  html:\n    theme: cosmo\n    toc: true\n    toc-depth: 3\n    toc-location: right\neditor: visual\nbibliography: Bayes101.bib\n---\n\n\n# Setup\n\nLoading some packages that will be used for demonstrations and analysis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)      # Data wrangling and plotting\nlibrary(ggdist)         # Easy and aesthetic plotting of distributions\nlibrary(ggExtra)        # Adding marginal distributions for 2d plots\nlibrary(tidybayes)      # Tidy processing of Bayesian models and extraction of MCMC chains\nlibrary(brms)           # Bayesian modeling and posterior estimation with MCMC using Stan\nlibrary(distributional) # Plotting of theoretical distributions (for likelihood functions plots)\n```\n:::\n\n\n# Motivation\n\nYou ran your experiment, collected the data, figured out how to download it in a normal form, and even cleaned and pre-processed it! All this for one simple linear regression model? In the current post I introduce the Bayesian approach for statistical modeling and inference, that can enrich your paper or thesis, and tell new stories using you data. The current post is by no means a full technical/theoretical/mathematical summary of Bayesian statistics and modeling. It's main purpose is to make things as simple and smooth for students who want to learn some new statistical analysis methods.\n\n# Introduction\n\nDependent on the stage you are in your academic career in Psychology, you are probably quite familiar with what I will refer to as *Frequentist* inferential statistics. The underlying assumption of these models is that *probability is relative frequency at infinity*. Every statistical test is conducted under the assumption of a particular world (the Null-Hypothesis).\\\nIn my opinion, this way of inference is intuitive to us only because we are so used to it. I argue that in the real world we update our knowledge in a different way. We assign *degrees of belief* to different possible hypotheses (worlds) - some worlds are more probable than others. When data is observed, it is used to *update* our beliefs, and make some possible worlds more probable, and others less probable.\n\nThe Bayesian interpretation of probability as degree of belief stands at the foundation of Bayesian statistical modeling (duh). We first assign probability to all possible worlds, than we observe the data, combining them together and update our beliefs.\n\n## Bayes theorem\n\n### Discrete events\n\nSo what is *Bayesian* about Bayesian statistics? going back to *Intro to statistics* in your BA, you learned to derive the Bayes theorem in probability: $$\nP(A|B)=\\frac{P(B|A) \\cdot P(A)}{P(B)}\n$$\n\nIn plain words: the probability of $A$ conditional on $B$ is equal to the product of the probability of $B$ conditional on $A$ and the prior probability of $A$, divided by the probability of $B$. The Bayes theorem gives a rigorous and mathematically defined way of updating beliefs in face of observed data. Sounds familiar? it should! this is exactly what you are doing (or at least want to do) in your thesis/research! you observe some *Data* and try to learn from it about the *World*. In your case, World = some statistical model = some set of parameters.[^1]\n\n[^1]: For example, consider the hypothesis that people in condition A are faster in a certain task than people in condition B. Your formal hypothesis look something like this: Reaction time follows a normal distribution with $\\mu=\\beta_0+\\beta_1condition$ and $\\sigma^2$. This model has 3 total parameters ($\\beta_0$, $\\beta_1$ and $\\sigma^2$).\n\n### Probability Distributions\n\nSo what is the probability of your hypothesized set of parameters given the data you observed? Replacing $A$ with your set of parameters, and $B$ with the observed data we get:\n\n$$\nP(Parameters|Data)=\\frac{P(Data|Parameters) \\cdot P(Parameters)}{P(Data)}\n$$\n\nOne thing that we need to remember is almost all[^2] of the terms above are no longer single probability values, but continuous probability *distributions*. For example, the term $P(Parameters)$ is a probability density distribution in which each possible combination of values of your parameters is assigned a probability.\n\n[^2]: The term $P(Data|Parameters)$ is not a probability distribution, but a special function called a *Likelihood* function and should be denoted by $L(Parameters|Data)$.\n\nEach of the terms above has an important role in the world of Bayesian modeling.\n\n### Likelihood\n\nThe term $P(Data|Parameters)$ describes the *likelihood* of the observed data under different sets of parameter values. In order to keep things simple I will not delve deeper into the theoretical aspects of likelihood (see @etz_introduction_2018, @pawitan_all_2001). The main things that are important to know as researchers about the likelihood function is that you are responsible to choosing it! For example, if I suspect that my dependent variable comes from a normal distribution (where you otherwise would fit some sort of linear model), I will use the normal likelihood function[^3]:\n\n[^3]: Which is identical to the normal density function.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nggplot(data = data.frame(x = c(-4, 4)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 1), linewidth = 1, color = \"#fca903\") +\n  ylab(expression(L(theta,x))) +\n  xlab(expression(theta)) +\n  scale_y_continuous(breaks = NULL) +\n  scale_x_continuous(breaks = seq(-4, 4, 1), labels = NULL) +\n  theme_classic() +\n  theme(axis.title = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nIf, on the other hand, I suspect that my dependent variable comes from a Poisson distribution (e.g. number of times a participant scratched their nose), I will use the Poisson likelihood function:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nggplot(data = data.frame(x = seq(0, 16, 1)), aes(x)) +\n  geom_line(aes(y = dpois(x, 6)), linewidth = 1, color = \"#fca903\") +\n  ylab(expression(L(theta,x))) +\n  xlab(expression(theta)) +\n  scale_y_continuous(breaks = NULL) +\n  scale_x_continuous(breaks = seq(0, 16, 1), labels = NULL) +\n  theme_classic() +\n  theme(axis.title = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nIn general, you need to define the *Data Generating Process (DGP)* - How were your observations generated?\\\nThis choice is analogous to the choice of statistical model/test in the frequentist paradigm. A linear model (t-test, ANOVA, linear regression) assumes a normal DGP, a Generalized linear model assumes some other DGP like a Binomial, Poisson, Inverse Gaussian etc.\n\n### Prior\n\nThe next term - $P(Parameters)$ is called the *Prior* probability distribution. This term represents the prior knowledge about the parameters in your model. Choosing a prior, a process that is sometime called *prior elicitation*, is difficult. How can one take into account all prior knowledge about something and neatly represent it with one probability distribution?? For this reason I will refer to 2 relatively-easy-to-define aspects of prior elicitation:\\\n\n-   *Range of possible/probable parameter values* - Some parameters can only take certain values, creating a-priori hard limits for their value. For example, a normal distribution's variance $\\sigma^2$ can only take positive values. Softer limits can also exist, for example: in a new/old recognition task, it is reasonable to predict that new items will be identified as new, more than old items - the regression coefficient should be positive. In the first case, a prior with hard boundary will be appropriate:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nggplot(data = data.frame(x = c(0, 13)), aes(x)) +\n  stat_function(fun = dexp, n = 101, args = list(rate = 1), linewidth = 1, fill = \"#a4c8f5\", color = \"#0373fc\", geom = \"area\", outline.type = \"upper\") +\n  ylab(expression(density(theta))) +\n  xlab(expression(theta)) +\n  scale_y_continuous(breaks = NULL) +\n  scale_x_continuous(breaks = seq(0, 13, 1)) +\n  labs(title = expression(Exp(1)), subtitle = \"Values below 0 are assigned a probability of 0\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 17, family = \"serif\", hjust = 0.5),\n        plot.subtitle = element_text(size = 13, family = \"serif\", hjust = 0.5),\n        axis.title = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nWhile in the second case, a prior like this would be better:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nggplot(data = data.frame(x = c(-5, 9)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 2, sd = 1.5), linewidth = 1, fill = \"#a4c8f5\", color = \"#0373fc\", geom = \"area\", outline.type = \"upper\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\", linewidth = 0.5) +\n  ylab(expression(density(theta))) +\n  xlab(expression(theta)) +\n  scale_y_continuous(breaks = NULL) +\n  scale_x_continuous(breaks = seq(-5, 9, 1)) +\n  labs(title = expression(N(2, 1.5^2)), subtitle = \"Negative values are possible, yet less probable than positive values\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 17, family = \"serif\", hjust = 0.5),\n        plot.subtitle = element_text(size = 13, family = \"serif\", hjust = 0.5),\n        axis.title = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n-   *Degree of informativeness* - Priors also differ from each other in their impact on the model. A prior can be weak or strong in this aspect.\n\n    -   *Weak Priors* - These priors are typically wide and cover a large range of possible values.\n    -   *Strong Priors* - These priors are narrower and leaves few parameter values probable.\n\n\n::: {.cell .column-screen-inset layout-nrow=\"1\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nggplot(data = data.frame(x = c(-28, 28)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 8), linewidth = 1, fill = \"#a4c8f5\", color = \"#0373fc\", geom = \"area\", outline.type = \"upper\") +\n  ylab(expression(density(theta))) +\n  xlab(expression(theta)) +\n  scale_y_continuous(breaks = NULL) +\n  scale_x_continuous(breaks = seq(-28, 28, 2)) +\n  labs(title = expression(N(0, 8^2))) +\n  theme_classic() +\n  theme(plot.title = element_text(size = 17, family = \"serif\", hjust = 0.5),\n        axis.title = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nggplot(data = data.frame(x = c(-28, 28)), aes(x)) +\n  stat_function(fun = dt, args = list(df = 10), linewidth = 1, fill = \"#a4c8f5\", color = \"#0373fc\", geom = \"area\", outline.type = \"upper\") +\n  ylab(expression(density(theta))) +\n  xlab(expression(theta)) +\n  scale_y_continuous(breaks = NULL) +\n  scale_x_continuous(breaks = seq(-28, 28, 2)) +\n  labs(title = expression(students_t(df = 10))) +\n  theme_classic() +\n  theme(plot.title = element_text(size = 17, family = \"serif\", hjust = 0.5),\n        axis.title = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n### Evidence\n\nThe denominator in Bayes' theorem - $P(Data)$ is called the evidence. It's important role is to act as the *standardizing* term to the numerator ($Likelihood \\cdot Prior$). Recall that the likelihood is not a probability distribution, so in order for it's product with the Prior - a probability distribution - to be equal to the Posterior - another probability distribution - a standardizing term is needed. This term is often impossible to calculate analytically, and therefore fancy numeric estimations are used.[^4]\n\n[^4]: For the math nerds, the evidence is defined as this integral: $\\int_{\\theta}P(X|\\theta)P(\\theta)d\\theta$.\n\n### Posterior\n\nThe posterior probability of your model - $P(Parameters|Data)$ - is the ultimate goal of your analysis. This probability distribution tells you what values of your parameters are probable and what values not so much. This is a shift of perspective from the usual frequentist logic - instead of resulting in one number as estimate for your parameter, you end up with a whole distribution!\\\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\nset.seed(14)\n\nmeans <- rnorm(10000, -2, 1.5)\nfreq_estimate <- mean(means)\n\nggplot(data.frame(y = means), aes(x = y)) +\n  geom_density(fill = \"#2ea64e\", color = \"#145726\", linewidth = 1) +\n  geom_point(data = data.frame(x = freq_estimate, y = 0), aes(x = x, y = y), size = 3) +\n  scale_x_continuous(limits = c(-7, 3), breaks = seq(-7, 3, 1), labels = seq(-7, 3, 1)) +\n  theme_classic() +\n  labs(title = \"Posterior probability distribution\", subtitle = \"The black dot represent the frequentist point estimate of the parameter\", x = expression(theta)) +\n  theme(axis.title.y = element_blank(),\n        axis.text.y = element_blank(),\n        axis.ticks.y = element_blank(),\n        plot.title = element_text(size = 17, family = \"serif\", hjust = .5),\n        plot.subtitle = element_text(size = 13, family = \"serif\", hjust = .5),\n        axis.title.x = element_text(size = 13),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nI think that Getting a posterior from the Likelihood and the prior makes more sense visually (make sure to also play with Kristoffer Magnusson's wonderful interactive [visualization](https://rpsychologist.com/d3/bayes/)):\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"simulated parameters\"}\nset.seed(14)\n\nactual_lambda <- 44\nn <- 24\ndata <- rpois(n, actual_lambda)\nprior_alpha <- 122.5\nprior_beta <- 3.5\n\nposterior_alpha <- prior_alpha + sum(data)\nposterior_beta <- prior_beta + n\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\npois_likelihood <- function(theta, data, scale = 1) {\n  sapply(theta, function(.theta) {\n    scale * exp(sum(dpois(data, lambda = .theta, log = T)))\n  })\n}\n\ndists <- data.frame(dist = c(\"Prior\", \"Posterior\"),\n                    Alpha = c(prior_alpha, posterior_alpha),\n                    Beta = c(prior_beta, posterior_beta)) |>\n  mutate(xdist = dist_gamma(shape = Alpha, rate = Beta))\n\nggplot(dists) +\n  geom_rug(aes(x = data, color = \"Likelihood\", fill = \"Likelihood\"), data = data.frame(), linewidth = 2) +\n  stat_slab(aes(xdist = xdist, fill = dist), normalize = \"none\", alpha = 0.6) +\n  stat_function(aes(color = \"Likelihood\"), fun = pois_likelihood,\n                args = list(data = data, scale = 7e33),\n                geom = \"line\", linewidth = 1) + \n  scale_fill_manual(breaks = c(\"Prior\", \"Likelihood\", \"Posterior\"), \n                    values = c(\"#a4c8f5\", \"#fca903\", \"#2ea64e\")) +\n  scale_color_manual(breaks = c(\"Prior\", \"Likelihood\", \"Posterior\"), \n                    values = c(\"black\", \"#fca903\", \"black\"),\n                    aesthetics = \"color\") +\n  coord_cartesian(ylim = c(0, 0.45), xlim = c(20, 70)) +\n  guides(colour = \"none\", fill = guide_legend(title = \"\")) +\n  theme_classic() +\n  labs(title = \"Posterior as a compromise between likelihood and prior\",\n       subtitle = \"Orange dots represent observed data\") +\n  theme(axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks.y = element_blank(),\n        plot.title = element_text(size = 17, family = \"serif\", hjust = .5),\n        plot.subtitle = element_text(size = 13, family = \"serif\", hjust = .5),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"),\n        legend.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note icon=\"false\"}\n## A note on higher dimesions\n\nAll of the examples above refer to estimation of one parameter. Often, your models will include several parameters (100's if you include random effects). So how does it work?\\\nwithout getting into detail, know that the simple one-parameter case scales quite nicely into *n*-parameter models. For example, instead of the $P(\\theta)$ prior from before, you can have $P(\\theta_0, \\theta_1,...,\\theta_n)$ prior. A prior of an intercept and a slope for a simple regression model could look like this:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"2d ggplot code\"}\nset.seed(14)\n\nmu0 <- -2\nmu1 <- 2.5\nsd0 <- 1.5\nsd1 <- 2\nr <- -0.54\n\ndata <- MASS::mvrnorm(n = 10000, mu = c(mu0, mu1), Sigma = matrix(c(sd0^2, sd0*sd1*r, sd0*sd1*r, sd1^2), nrow = 2)) |>\n  data.frame() |>\n  rename(b0 = X1, b1 = X2) |>\n  mutate(b0 = b0 + runif(1, -4, 4)^2,\n         b1 = b1 + runif(1, -1, 1)^2)\n\np <- data |>\n  ggplot(aes(x = b0, y = b1)) +\n    geom_point() +\n    stat_density_2d(aes(fill = after_stat(density)), geom = \"raster\", contour = F) +\n    theme_classic() +\n    labs(x = expression(beta[0]), y = expression(beta[1])) +\n    scale_x_continuous(expand = c(0, 0), limits = c(-6, 12), breaks = seq(-6, 12, 2)) +\n    scale_y_continuous(expand = c(0, 0), limits = c(-6, 12), breaks = seq(-6, 12, 2)) +\n    scale_fill_fermenter(palette = \"Blues\", direction = 1) +\n    theme(legend.position = \"none\",\n          axis.title = element_text(size = 13))\n\nggMarginal(p, type = \"density\",\n           xparams = list(fill = \"#a4c8f5\", colour = \"black\"),\n           yparams = list(fill = \"#a4c8f5\", colour = \"black\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nIn general, we will denote $\\theta$ to be the set of *m* parameters $[\\theta_0, \\theta_1,...,\\theta_m]$, and $X$ as the set of *n* data points $[x_1, x_2,...,x_n]$.\n:::\n\n# Bayesian Modeling - How to do it?\n\nHow to actually estimate the posterior probability of our parameters? As we seen before, we will need to define a prior for all parameters, we will need to choose the likelihood function, and we will need to calculate that annoying evidence in the denominator.\\\n\nAll of this made easy with the amazing `brms` package (@burkner_brms_2017).\n\n## brms setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"brms\")\nlibrary(brms)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n::: callout-important\n`brms` is actually translating your `R` code into *Stan* (@stan_development_team_stan_2018), a programming language that is specialized in estimating posterior distributions. Therefore, you will also need to install some sort of *backend*. Using `cmdstanr` is probably optimal, but because it's installation can be tricky, `Rstan` is another option.\n:::\n\n## Simple linear regression\n\nLet's start with the most simple example. Consider the sex differences in cats' body weight:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- MASS::cats\n\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Sex Bwt Hwt\n1   F 2.0 7.0\n2   F 2.0 7.4\n3   F 2.0 9.5\n4   F 2.1 7.2\n5   F 2.1 7.3\n6   F 2.1 7.6\n```\n:::\n:::\n\n\nFitting a linear regression model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_cats <- lm(Bwt ~ Sex,\n              data = data)\n\nparameters::model_parameters(lm_cats) |> insight::print_html()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ouafjobozd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ouafjobozd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ouafjobozd thead, #ouafjobozd tbody, #ouafjobozd tfoot, #ouafjobozd tr, #ouafjobozd td, #ouafjobozd th {\n  border-style: none;\n}\n\n#ouafjobozd p {\n  margin: 0;\n  padding: 0;\n}\n\n#ouafjobozd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 100%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ouafjobozd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ouafjobozd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ouafjobozd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ouafjobozd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ouafjobozd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ouafjobozd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ouafjobozd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ouafjobozd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ouafjobozd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ouafjobozd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ouafjobozd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ouafjobozd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ouafjobozd .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ouafjobozd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ouafjobozd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ouafjobozd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ouafjobozd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ouafjobozd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ouafjobozd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ouafjobozd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ouafjobozd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ouafjobozd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ouafjobozd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ouafjobozd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ouafjobozd .gt_left {\n  text-align: left;\n}\n\n#ouafjobozd .gt_center {\n  text-align: center;\n}\n\n#ouafjobozd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ouafjobozd .gt_font_normal {\n  font-weight: normal;\n}\n\n#ouafjobozd .gt_font_bold {\n  font-weight: bold;\n}\n\n#ouafjobozd .gt_font_italic {\n  font-style: italic;\n}\n\n#ouafjobozd .gt_super {\n  font-size: 65%;\n}\n\n#ouafjobozd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ouafjobozd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ouafjobozd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ouafjobozd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ouafjobozd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ouafjobozd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ouafjobozd .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SE\">SE</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"95% CI\">95% CI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"t(142)\">t(142)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">(Intercept)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">2.36</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.06</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(2.24, 2.48)</td>\n<td headers=\"t(142)\" class=\"gt_row gt_center\">39.00</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">Sex (M)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.54</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.07</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(0.39, 0.69)</td>\n<td headers=\"t(142)\" class=\"gt_row gt_center\">7.33</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"6\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n:::\n:::\n\n\nMale cats weigh $0.54$ Kg more than female cats, and this difference is statistically significant.\n\n# Bayesian Modeling - Doing it!\n\n## Prior elicitation\n\nHow many parameters are there?\\\n1. Intercept - Representing the value of `Bwt` when the IV is $0$. Meaning it is the estimated mean weight of female cats.\\\n2. Slope of $SexMale$ - Estimated difference in body weight between male and female cats.\\\n3. Sigma - The variance of the residuals (variance of the conditional-mean normal distribution of `Bwt`).\\\n\nWhat prior knowledge can we incorporate into each parameter?\\\n1. average weight of female cats should probably be \\~2Kg-3Kg.\\\n2. Male cats should probably weight more than female cats.\\\n3. The sigma is not so interesting, so I will just define a wide prior.\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprior <- set_prior(\"normal(2.5, 2)\", class = \"Intercept\") +\n  set_prior(\"normal(1, 2)\", coef = \"SexM\") +\n  set_prior(\"exponential(0.01)\", class = \"sigma\")\n```\n:::\n\n\n::: column-margin\n## Tip\n\nIf you are not sure what are the parameters of your model, use the `brms::get_prior()` function to get your model's parameters and their default `brms` priors.\n:::\n\n#### Posterior estimation\n\n\n::: {.cell}\n\n:::\n\n\nIn case you missed it, we already defined our likelihood function to be the normal likelihood function. This is implicit in our choice of the ordinary linear regression model.\n\n::: callout-important\n## Convergence Measures\n\nRecall that because of the annoying Bayes' denominator (*Evidence* - $P(Data)$) estimating the posterior is usually quite tricky. For that reason it is done with an algorithm called MCMC sampling (Monte Carlo Markov Chain), that samples numbers from the posterior distribution. The posterior estimated is therefore just a list of numbers (a Markov Chain) sampled from the posterior. *Diagnostics* - MCMC samples tend to be auto-correlated (further read @kruschke_markov_2014, chapter 7), and therefore convey less information about the distribution than an independent sample. The actual sample size of the MCMC algorithm 'is worth' less than an independent sample size.\n\n-   *Effective Sample Size (ESS)* represents the independent sample size roughly equivalent to your MCMC sample size, and is calculated as:\n\n$$\nESS=\\frac{N}{\\hat{\\tau}}\n$$ Where $\\hat{\\tau}$ is a measure of chain auto-correlation (with a minimum value of $1$). It is recommended to get at least $ESS>1000$.\n\n-   *Chain mixing (R-hat)* - when sampling more than two chains or more (most of the times), we will want to check if all of them converge to the same distribution. This is measured with the $\\hat{R}$ measure (@vehtari_rank-normalization_2021) which equals to $1$ when convergence is maximal. Values above $1.01$ are not good.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"tidybayes & ggplot code\"}\np <- spread_draws(posterior, b_Intercept) |>\n  ggplot(aes(x = .iteration, y = b_Intercept)) +\n    geom_line(aes(color = factor(.chain))) +\n    scale_color_manual(values = c(\"#8338E3\", \"#A25ED6\", \"#C183C8\", \"#E0A9BB\")) +\n    theme_classic() +\n    labs(color = \"Chain\", x = \"Sample's index\", title = \"Good between-chain convergence looks like a fuzzy caterpillar!\") +\n    theme(strip.background = element_blank(),\n          strip.text.x = element_blank(),\n          axis.title.y = element_blank(),\n          axis.title = element_text(size = 13, family = \"serif\"),\n          plot.title = element_text(size = 17, family = \"serif\", hjust = 0.5),\n          plot.background = element_rect(fill = \"#E3E2DF\"),\n          panel.background = element_rect(fill = \"#E3E2DF\"),\n          legend.background = element_rect(fill = \"#E3E2DF\"))\n\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n:::\n\nOne last thing before fitting the model, this is code snippet is necessary when using the `cmdstanr` backend for `brms`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncmdstanr::set_cmdstan_path(path = \"your_path_to_cmdstanr_directory\")\n```\n:::\n\n\nNow for posterior estimation!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior <- brm(formula = Bwt ~ Sex,\n                 data = data,\n                 prior = prior,\n                 backend = \"cmdstanr\", # this is where the backend is defined\n                 seed = 14) # setting a seed for the random MCMC sampling algorithm\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nAfter compiling the Stan code and running the algorithm, we get our posterior distribution:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(posterior)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nOn the right we can see the Markov Chains and their (good) convergence, and on the left we can see the marginal posterior distribution of every parameter. Let's inspect the *R-hat* and *ESS* convergence measures (aiming at $\\hat{R} \\le 1.01$ and $ESS \\ge 1000$):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrms::rhat(posterior)[1:2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nb_Intercept      b_SexM \n   1.000458    1.000181 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbayestestR::effective_sample(posterior) |> insight::print_html()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ankbflamze\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ankbflamze table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ankbflamze thead, #ankbflamze tbody, #ankbflamze tfoot, #ankbflamze tr, #ankbflamze td, #ankbflamze th {\n  border-style: none;\n}\n\n#ankbflamze p {\n  margin: 0;\n  padding: 0;\n}\n\n#ankbflamze .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ankbflamze .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ankbflamze .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ankbflamze .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ankbflamze .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ankbflamze .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ankbflamze .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ankbflamze .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ankbflamze .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ankbflamze .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ankbflamze .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ankbflamze .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ankbflamze .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ankbflamze .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ankbflamze .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ankbflamze .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ankbflamze .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ankbflamze .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ankbflamze .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ankbflamze .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ankbflamze .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ankbflamze .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ankbflamze .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ankbflamze .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ankbflamze .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ankbflamze .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ankbflamze .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ankbflamze .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ankbflamze .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ankbflamze .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ankbflamze .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ankbflamze .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ankbflamze .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ankbflamze .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ankbflamze .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ankbflamze .gt_left {\n  text-align: left;\n}\n\n#ankbflamze .gt_center {\n  text-align: center;\n}\n\n#ankbflamze .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ankbflamze .gt_font_normal {\n  font-weight: normal;\n}\n\n#ankbflamze .gt_font_bold {\n  font-weight: bold;\n}\n\n#ankbflamze .gt_font_italic {\n  font-style: italic;\n}\n\n#ankbflamze .gt_super {\n  font-size: 65%;\n}\n\n#ankbflamze .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ankbflamze .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ankbflamze .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ankbflamze .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ankbflamze .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ankbflamze .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ankbflamze .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ESS\">ESS</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\">b_Intercept</td>\n<td headers=\"ESS\" class=\"gt_row gt_center\">3946</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\">b_SexM</td>\n<td headers=\"ESS\" class=\"gt_row gt_center\">4140</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"2\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThese measures also appear in the `parameters::model_parameters()` summary, so no need to actually calculate them separately.\n\nIf we omit the annoying sigma parameter, we can visualize the 2D posterior of the Intercept and Slope:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"tidybayes & ggplot code\"}\ndraws <- spread_draws(posterior, b_Intercept, b_SexM)\n\np <- draws |>\n  ggplot(aes(x = b_Intercept, y = b_SexM)) +\n  geom_point() +\n    stat_density_2d(aes(fill = after_stat(density)), geom = \"raster\", contour = F) +\n    theme_classic() +\n    labs(x = \"Intercept\", y = \"Sex[Male]\") +\n    scale_x_continuous(expand = c(0, 0)) +\n    scale_y_continuous(expand = c(0, 0)) +\n    scale_fill_fermenter(palette = \"Greens\", direction = 1) +\n    theme(legend.position = \"none\",\n          axis.title = element_text(size = 13))\n\nggMarginal(p, type = \"density\",\n           xparams = list(fill = \"#2ea64e\", colour = \"black\"),\n           yparams = list(fill = \"#2ea64e\", colour = \"black\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nWe can also inspect the posterior of the `SexM` coefficient alone (sex difference in weight) - also called a *marginal posterior*:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\np <- draws |>\n  ggplot(aes(x = b_SexM)) + \n  stat_density(fill = \"#2ea64e\", color = \"#145726\", linewidth = 1) +\n  theme_classic() +\n  scale_x_continuous(limits = c(-0.2, 1), breaks = seq(-0.2, 1, 0.1)) +\n  theme(axis.text.y = element_blank(),\n        axis.ticks.y = element_blank(),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"),\n        legend.background = element_rect(fill = \"#E3E2DF\"))\n\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nNotice the values most probable in the posterior are in the range of our hypothesis, and also in the range of the frequentist model. Some calculations that can be done on the posterior include:\n\n##### Probability of direction\n\nHow much of the posterior is negative/positive? The answer to this question gives the probability that the parameter is different from zero:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"ggplot code\"}\np <- draws |>\n  ggplot(aes(x = b_SexM)) + \n  stat_density(fill = \"#2ea64e\", color = \"#145726\", linewidth = 1) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", linewidth = 0.8) +\n  theme_classic() +\n  scale_x_continuous(limits = c(-0.2, 1), breaks = seq(-0.2, 1, 0.1)) +\n  theme(axis.text.y = element_blank(),\n        axis.ticks.y = element_blank(),\n        plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"),\n        legend.background = element_rect(fill = \"#E3E2DF\"))\n\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nThe posterior is entirely positive, yielding a 100% probability that the parameter is positive.\n\nCan also be done with `bayestestR` wonderful functions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbayestestR::p_direction(posterior, parameters = \"b_SexM\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nProbability of Direction\n\nParameter |   pd\n----------------\nSexM      | 100%\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(bayestestR::p_direction(posterior, parameters = \"b_SexM\")) +\n  scale_fill_manual(values = \"#2ea64e\") +\n  theme(plot.background = element_rect(fill = \"#E3E2DF\"),\n        panel.background = element_rect(fill = \"#E3E2DF\"),\n        legend.background = element_rect(fill = \"#E3E2DF\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n##### Highest Density Interval (HDI)\n\nA common misconception of the frequentist's confidence interval (with 95% credibility) is that it has a 95% probability of containing the true value of the parameter. The Bayesian Highest Density Interval however gives exactly this. The main 95% of the posterior have a 95% probability of containing the real value of the parameter. 95% are obviously arbitrary, and can be defined to anything else:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting the HDI\"}\np <- bayestestR::hdi(posterior, parameters = \"b_SexM\", ci = 0.89) |>\n  plot() +\n    theme_classic() +\n    scale_fill_manual(values = c(\"#145726\", \"#2ea64e\")) +\n    scale_x_continuous(limits = c(0.25, 0.85), breaks = seq(0.25, 0.85, 0.1)) +\n    labs(x = \"Sex [Male]\", title = \"Highest Density Interval\", subtitle = \"The shaded area has a 89% probability of containing the real value of the parameter\", y = \"\") +\n    theme(legend.position = \"none\",\n          axis.title.x = element_text(size = 13, family = \"serif\"),\n          plot.title = element_text(size = 17, family = \"serif\", hjust = 0.5),\n          plot.subtitle = element_text(size = 13, family = \"serif\", hjust = 0.5),\n          plot.background = element_rect(fill = \"#E3E2DF\"),\n          panel.background = element_rect(fill = \"#E3E2DF\"),\n          legend.background = element_rect(fill = \"#E3E2DF\"))\n\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n##### Point estimates\n\nIt is also possible to summarize the posterior distribution with point estimates like the mean, median and mode (Maximum A-posteriori Point - MAP). This is done easily with the `model_parameters()` function from the `parameters` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters::model_parameters(posterior, centrality = \"all\") |> insight::print_html()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"qwqvncvcxj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qwqvncvcxj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qwqvncvcxj thead, #qwqvncvcxj tbody, #qwqvncvcxj tfoot, #qwqvncvcxj tr, #qwqvncvcxj td, #qwqvncvcxj th {\n  border-style: none;\n}\n\n#qwqvncvcxj p {\n  margin: 0;\n  padding: 0;\n}\n\n#qwqvncvcxj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 100%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qwqvncvcxj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qwqvncvcxj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qwqvncvcxj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qwqvncvcxj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qwqvncvcxj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qwqvncvcxj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qwqvncvcxj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qwqvncvcxj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qwqvncvcxj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qwqvncvcxj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qwqvncvcxj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qwqvncvcxj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qwqvncvcxj .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qwqvncvcxj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwqvncvcxj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qwqvncvcxj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qwqvncvcxj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qwqvncvcxj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwqvncvcxj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qwqvncvcxj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwqvncvcxj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qwqvncvcxj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwqvncvcxj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qwqvncvcxj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwqvncvcxj .gt_left {\n  text-align: left;\n}\n\n#qwqvncvcxj .gt_center {\n  text-align: center;\n}\n\n#qwqvncvcxj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qwqvncvcxj .gt_font_normal {\n  font-weight: normal;\n}\n\n#qwqvncvcxj .gt_font_bold {\n  font-weight: bold;\n}\n\n#qwqvncvcxj .gt_font_italic {\n  font-style: italic;\n}\n\n#qwqvncvcxj .gt_super {\n  font-size: 65%;\n}\n\n#qwqvncvcxj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qwqvncvcxj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qwqvncvcxj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qwqvncvcxj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qwqvncvcxj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qwqvncvcxj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qwqvncvcxj .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Model Summary</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Median\">Median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"MAP\">MAP</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"95% CI\">95% CI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pd\">pd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rhat\">Rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ESS\">ESS</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"8\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Fixed Effects \">Fixed Effects </th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">(Intercept)</td>\n<td headers=\"Fixed Effects   Median\" class=\"gt_row gt_center\">2.36</td>\n<td headers=\"Fixed Effects   Mean\" class=\"gt_row gt_center\">2.36</td>\n<td headers=\"Fixed Effects   MAP\" class=\"gt_row gt_center\">2.36</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(2.24, 2.48)</td>\n<td headers=\"Fixed Effects   pd\" class=\"gt_row gt_center\">100%</td>\n<td headers=\"Fixed Effects   Rhat\" class=\"gt_row gt_center\">1.000</td>\n<td headers=\"Fixed Effects   ESS\" class=\"gt_row gt_center\">3946.00</td></tr>\n    <tr><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">SexM</td>\n<td headers=\"Fixed Effects   Median\" class=\"gt_row gt_center\">0.54</td>\n<td headers=\"Fixed Effects   Mean\" class=\"gt_row gt_center\">0.54</td>\n<td headers=\"Fixed Effects   MAP\" class=\"gt_row gt_center\">0.53</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(0.40, 0.69)</td>\n<td headers=\"Fixed Effects   pd\" class=\"gt_row gt_center\">100%</td>\n<td headers=\"Fixed Effects   Rhat\" class=\"gt_row gt_center\">1.000</td>\n<td headers=\"Fixed Effects   ESS\" class=\"gt_row gt_center\">4140.00</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"8\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Sigma \">Sigma </th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Sigma   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">sigma</td>\n<td headers=\"Sigma   Median\" class=\"gt_row gt_center\">0.42</td>\n<td headers=\"Sigma   Mean\" class=\"gt_row gt_center\">0.42</td>\n<td headers=\"Sigma   MAP\" class=\"gt_row gt_center\">0.41</td>\n<td headers=\"Sigma   95% CI\" class=\"gt_row gt_center\">(0.37, 0.47)</td>\n<td headers=\"Sigma   pd\" class=\"gt_row gt_center\">100%</td>\n<td headers=\"Sigma   Rhat\" class=\"gt_row gt_center\">1.000</td>\n<td headers=\"Sigma   ESS\" class=\"gt_row gt_center\">3277.00</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"8\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n:::\n:::\n\n\n# Conclusion\n\nThis post is just a brief introduction of Bayesian statistical modeling. For those psychology students who want to enrich their statistical analyses, it should provide the basic tools and intuition. This post will be followed up with a deeper dive in to more complex models (multiple linear models, mixed-effects linear models, generalized linear models, ordinal regression models...).\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}